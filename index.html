
<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>O Que Assistir - Encontre seu próximo filme ou série</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="icon" type="image/x-icon" href="https://ico.buildglarecontent.com/oqueassistir/favicon.ico">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
      body {
        font-family: 'Roboto', sans-serif;
      }
      
      input[type=range] {
        -webkit-appearance: none;
        appearance: none;
        width: 100%;
        height: 8px;
        background: #2d2d2d;
        border-radius: 5px;
        outline: none;
      }
      
      input[type=range]::-webkit-slider-thumb {
        -webkit-appearance: none;
        appearance: none;
        width: 24px;
        height: 24px;
        background: #E50914;
        border-radius: 50%;
        cursor: pointer;
      }
      
      input[type=range]::-moz-range-thumb {
        width: 24px;
        height: 24px;
        background: #E50914;
        border-radius: 50%;
        cursor: pointer;
      }
      
      .time-button.active, .mood-button.active, .streaming-button.active {
        background-color: #E50914;
        transform: scale(1.05);
      }
      
      .suggestion-card {
        transition: all 0.3s ease;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      }
      
      .suggestion-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 10px 15px -3px rgba(229, 9, 20, 0.3);
      }
    
      /* Novos estilos adicionados */
      .line-clamp-2 {
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
      }
    
      /* Ajustes para a área de sugestões */
      #suggestionArea {
        transition: all 0.3s ease;
      }
    
      #multipleSuggestions > div {
        gap: 1.5rem;
        padding: 0.5rem;
      }
    
      /* Ajustes para telas menores */
      @media (max-width: 768px) {
        #multipleSuggestions > div {
          grid-template-columns: 1fr;
        }
        
        .suggestion-card {
          max-width: 100%;
          margin: 0 auto;
        }
    
        /* Ajuste para a visualização única em mobile */
        #singleSuggestion {
          flex-direction: column;
        }
        
        #singleSuggestion > div:first-child {
          width: 100%;
          margin-bottom: 1.5rem;
        }
      }
    
      /* Melhorias nos cards */
      .suggestion-card .aspect-\[2\/3\] {
        position: relative;
      }
    
      .suggestion-card img {
        transition: transform 0.3s ease, opacity 0.3s ease;
      }
    
      .suggestion-card:hover img {
        transform: scale(1.02);
      }
    
      /* Ajustes no texto */
      #singleDescription {
        line-height: 1.6;
        margin-bottom: 1.5rem;
      }
    
      /* Espaçamento melhorado para os botões */
      #dislikeSingle, .dislike-button {
        transition: all 0.2s ease;
      }
    
      #dislikeSingle:hover, .dislike-button:hover {
        transform: translateY(-2px);
      }
    
      /* Ajuste para os badges de informação */
      .bg-\[\#3d3d3d\] {
        padding: 0.25rem 0.5rem;
        font-size: 0.75rem;
      }
    
      /* Melhor espaçamento para a visualização única */
      #singleSuggestion > div:last-child {
        padding: 1rem;
      }
    
      @media (min-width: 768px) {
        #singleSuggestion > div:last-child {
          padding: 1.5rem;
        }
      }
    </style>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3855831134101762"
    crossorigin="anonymous"></script>
    <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HDY97LCBZC"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HDY97LCBZC');
</script>
  </head>
  <body class="bg-[#121212] text-white min-h-screen flex flex-col font-roboto">
    <main class="container mx-auto px-4 py-8 flex-grow flex flex-col items-center justify-center max-w-3xl">
      <h1 class="text-4xl md:text-5xl font-bold text-center mb-8">O Que Assistir?</h1>
      
      <div class="w-full space-y-8">
        <!-- Time Selection Section -->
        
<section id="timeSelector" class="bg-[#1e1e1e] p-6 rounded-xl shadow-lg">
<h2 class="text-2xl font-bold mb-4">Quanto tempo você tem?</h2>

<div class="flex flex-wrap gap-3 mb-6">
  <button class="time-button flex-1 bg-[#2d2d2d] hover:bg-[#3d3d3d] text-white py-3 px-4 rounded-full transition-all" data-time="60">
    Menos de 1h
  </button>
  <button class="time-button flex-1 bg-[#2d2d2d] hover:bg-[#3d3d3d] text-white py-3 px-4 rounded-full transition-all" data-time="120">
    1h–2h
  </button>
  <button class="time-button flex-1 bg-[#2d2d2d] hover:bg-[#3d3d3d] text-white py-3 px-4 rounded-full transition-all" data-time="240">
    Madrugada adentro
  </button>
</div>

<div class="mt-6">
  <div class="flex justify-between text-sm mb-1">
    <span>30min</span>
    <span id="timeValue">120min</span>
    <span>240min</span>
  </div>
  <input 
    type="range" 
    id="timeSlider" 
    min="30" 
    max="240" 
    step="5" 
    value="120"
    class="w-full"
  >
</div>
</section>

        
        <!-- Mood Selection Section -->
        
<section id="moodSelector" class="bg-[#1e1e1e] p-6 rounded-xl shadow-lg">
<h2 class="text-2xl font-bold mb-4">Qual seu humor hoje?</h2>

<div class="grid grid-cols-2 md:grid-cols-5 gap-3">
  <button class="mood-button bg-[#2d2d2d] hover:bg-[#3d3d3d] text-white py-4 px-2 rounded-xl transition-all flex flex-col items-center" data-mood="alegre">
    <span class="text-4xl mb-2">😊</span>
    <span>Alegre</span>
  </button>
  
  <button class="mood-button bg-[#2d2d2d] hover:bg-[#3d3d3d] text-white py-4 px-2 rounded-xl transition-all flex flex-col items-center" data-mood="nervoso">
    <span class="text-4xl mb-2">😡</span>
    <span>Nervoso</span>
  </button>
  
  <button class="mood-button bg-[#2d2d2d] hover:bg-[#3d3d3d] text-white py-4 px-2 rounded-xl transition-all flex flex-col items-center" data-mood="bizarro">
    <span class="text-4xl mb-2">🤪</span>
    <span>Bizarro</span>
  </button>
  
  <button class="mood-button bg-[#2d2d2d] hover:bg-[#3d3d3d] text-white py-4 px-2 rounded-xl transition-all flex flex-col items-center" data-mood="romântico">
    <span class="text-4xl mb-2">💘</span>
    <span>Romântico</span>
  </button>
  
  <button class="mood-button bg-[#2d2d2d] hover:bg-[#3d3d3d] text-white py-4 px-2 rounded-xl transition-all flex flex-col items-center md:col-span-1 col-span-2" data-mood="inteligente">
    <span class="text-4xl mb-2">🧠</span>
    <span>Inteligente</span>
  </button>
</div>
</section>

        
        <!-- Streaming Selection Section -->
        
<section id="streamingSelector" class="bg-[#1e1e1e] p-6 rounded-xl shadow-lg mt-8">
<h2 class="text-2xl font-bold mb-4">Em qual streaming? (opcional)</h2>

<div class="grid grid-cols-2 md:grid-cols-5 gap-3">
  <button class="streaming-button active bg-[#2d2d2d] hover:bg-[#3d3d3d] text-white py-4 px-2 rounded-xl transition-all flex flex-col items-center" data-streaming="">
    <span class="text-4xl mb-2">🎬</span>
    <span>Qualquer</span>
  </button>
  
  <button class="streaming-button bg-[#2d2d2d] hover:bg-[#3d3d3d] text-white py-4 px-2 rounded-xl transition-all flex flex-col items-center" data-streaming="netflix">
    <span class="text-4xl mb-2">🔴</span>
    <span>Netflix</span>
  </button>
  
  <button class="streaming-button bg-[#2d2d2d] hover:bg-[#3d3d3d] text-white py-4 px-2 rounded-xl transition-all flex flex-col items-center" data-streaming="prime">
    <span class="text-4xl mb-2">📦</span>
    <span>Prime Video</span>
  </button>
  
  <button class="streaming-button bg-[#2d2d2d] hover:bg-[#3d3d3d] text-white py-4 px-2 rounded-xl transition-all flex flex-col items-center" data-streaming="disney">
    <span class="text-4xl mb-2">✨</span>
    <span>Disney+</span>
  </button>
  
  <button class="streaming-button bg-[#2d2d2d] hover:bg-[#3d3d3d] text-white py-4 px-2 rounded-xl transition-all flex flex-col items-center" data-streaming="hbo">
    <span class="text-4xl mb-2">🔵</span>
    <span>HBO Max</span>
  </button>
</div>
</section>

        
        <!-- Action Button -->
        <div class="text-center mt-10">
          <button id="surpriseButton" class="bg-[#E50914] hover:bg-[#f40612] text-white text-xl font-bold py-4 px-8 rounded-full transition-all transform hover:scale-105">
            Me Surpreenda!
          </button>
        </div>
        
        <!-- Suggestions Area (Initially Hidden) -->
        
<section id="suggestionArea" class="bg-[#1e1e1e] p-6 rounded-xl shadow-lg mt-8 hidden">
<h2 class="text-2xl font-bold mb-6">Sugestão para você:</h2>

<!-- Single Suggestion View -->
<div id="singleSuggestion" class="hidden">
  <div class="bg-[#2d2d2d] rounded-xl p-5 flex flex-col md:flex-row gap-6 items-center">
    <div class="w-full md:w-1/3 aspect-[2/3] bg-gray-800 rounded-lg overflow-hidden">
      <img id="singlePoster" src="" alt="Poster do filme" class="w-full h-full object-cover">
    </div>
    
    <div class="flex-1">
      <h3 id="singleTitle" class="text-2xl font-bold mb-2"></h3>
      <div class="flex items-center gap-2 mb-3">
        <span id="singleDuration" class="bg-[#3d3d3d] text-sm px-2 py-1 rounded"></span>
        <span id="singleYear" class="bg-[#3d3d3d] text-sm px-2 py-1 rounded"></span>
      </div>
      <p id="singleDescription" class="text-gray-300 mb-4"></p>
      <div class="flex items-center gap-2 mb-4">
        <span class="text-gray-400">Disponível em:</span>
        <span id="singleStreaming" class="bg-[#E50914] px-3 py-1 rounded-full text-sm font-medium"></span>
      </div>
      <button id="dislikeSingle" class="mt-2 bg-[#3d3d3d] hover:bg-[#4d4d4d] text-white py-2 px-4 rounded-full transition-all">
        Não gostei! Me dê outra
      </button>
    </div>
  </div>
</div>

<!-- Multiple Suggestions View -->
<div id="multipleSuggestions" class="hidden">
  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <!-- Cards will be dynamically inserted here -->
  </div>
</div>
</section>

      </div>
    </main>
    
    <footer class="py-4 text-center text-gray-400 text-sm">
      <p>© 2025 O Que Assistir - Encontre o que assistir baseado no seu tempo e humor</p>
    </footer>
    
    
<script>
// DOM Elements
const timeButtons = document.querySelectorAll('.time-button');
const timeSlider = document.getElementById('timeSlider');
const timeValue = document.getElementById('timeValue');
const moodButtons = document.querySelectorAll('.mood-button');
const streamingButtons = document.querySelectorAll('.streaming-button');
const surpriseButton = document.getElementById('surpriseButton');
const suggestionArea = document.getElementById('suggestionArea');
const singleSuggestion = document.getElementById('singleSuggestion');
const multipleSuggestions = document.getElementById('multipleSuggestions');

// State
let selectedTime = 120;
let selectedMood = null;
let selectedStreaming = "";
let isLoading = false;

// Initialize
timeSlider.value = selectedTime;
updateTimeValue();

// Initialize streaming (set "Qualquer" as default)
document.querySelector('.streaming-button[data-streaming=""]').classList.add('active');

// Event Listeners
timeButtons.forEach(button => {
  button.addEventListener('click', () => {
    // Remove active class from all buttons
    timeButtons.forEach(btn => btn.classList.remove('active'));
    
    // Add active class to clicked button
    button.classList.add('active');
    
    // Update selected time
    selectedTime = parseInt(button.dataset.time);
    
    // Update slider
    timeSlider.value = selectedTime;
    updateTimeValue();
  });
});

timeSlider.addEventListener('input', () => {
  // Update selected time
  selectedTime = parseInt(timeSlider.value);
  
  // Update time value display
  updateTimeValue();
  
  // Remove active class from all buttons
  timeButtons.forEach(btn => btn.classList.remove('active'));
  
  // Add active class to corresponding button if exists
  timeButtons.forEach(btn => {
    if (parseInt(btn.dataset.time) === selectedTime) {
      btn.classList.add('active');
    }
  });
});

moodButtons.forEach(button => {
  button.addEventListener('click', () => {
    // Remove active class from all buttons
    moodButtons.forEach(btn => btn.classList.remove('active'));
    
    // Add active class to clicked button
    button.classList.add('active');
    
    // Update selected mood
    selectedMood = button.dataset.mood;
  });
});

// Fix streaming buttons
streamingButtons.forEach(button => {
  button.addEventListener('click', () => {
    // Remove active class from all buttons
    streamingButtons.forEach(btn => btn.classList.remove('active'));
    
    // Add active class to clicked button
    button.classList.add('active');
    
    // Update selected streaming
    selectedStreaming = button.dataset.streaming;
    console.log('Selected streaming:', selectedStreaming);
  });
});

// Make sure streaming buttons are initialized correctly
document.addEventListener('DOMContentLoaded', () => {
  // Set default streaming button active
  const defaultStreamingButton = document.querySelector('.streaming-button[data-streaming=""]');
  if (defaultStreamingButton) {
    defaultStreamingButton.classList.add('active');
    selectedStreaming = "";
  }
});

surpriseButton.addEventListener('click', async () => {
  if (!selectedTime) {
    alert('Por favor, selecione um tempo disponível!');
    return;
  }
  
  if (!selectedMood) {
    alert('Por favor, seleccione seu humor!');
    return;
  }
  
  if (isLoading) return;
  
  try {
    isLoading = true;
    surpriseButton.textContent = 'Carregando...';
    surpriseButton.disabled = true;
    
    // Fetch suggestions from API
    const suggestions = await fetchSuggestions(selectedTime, selectedMood, selectedStreaming);
    
    if (!suggestions || suggestions.length === 0) {
      alert('Não encontramos sugestões com esses critérios. Tente aumentar o tempo ou escolher outro humor.');
      isLoading = false;
      surpriseButton.textContent = 'Me Surpreenda!';
      surpriseButton.disabled = false;
      return;
    }
    
    // Show suggestion area
    suggestionArea.classList.remove('hidden');
    
    // Randomly decide to show single or multiple suggestions
    const showSingle = Math.random() > 0.5 || suggestions.length === 1;
    
    if (showSingle) {
      // Show single suggestion
      singleSuggestion.classList.remove('hidden');
      multipleSuggestions.classList.add('hidden');
      
      // Get random suggestion
      const randomIndex = Math.floor(Math.random() * suggestions.length);
      const suggestion = suggestions[randomIndex];
      
      // Update UI
      updateSingleSuggestion(suggestion);
      
      // Setup dislike button
      document.getElementById('dislikeSingle').onclick = async () => {
        if (isLoading) return;
        
        try {
          isLoading = true;
          document.getElementById('dislikeSingle').textContent = 'Carregando...';
          document.getElementById('dislikeSingle').disabled = true;
          
          // Fetch new suggestions
          const newSuggestions = await fetchSuggestions(selectedTime, selectedMood, selectedStreaming);
          
          if (!newSuggestions || newSuggestions.length === 0) {
            alert('Não temos mais sugestões com esses critérios. Tente outros filtros!');
            suggestionArea.classList.add('hidden');
            isLoading = false;
            document.getElementById('dislikeSingle').textContent = 'Não gostei! Me dê outra';
            document.getElementById('dislikeSingle').disabled = false;
            return;
          }
          
          // Get new random suggestion
          const newRandomIndex = Math.floor(Math.random() * newSuggestions.length);
          const newSuggestion = newSuggestions[newRandomIndex];
          
          // Update UI
          updateSingleSuggestion(newSuggestion);
          
          isLoading = false;
          document.getElementById('dislikeSingle').textContent = 'Não gostei! Me dê outra';
          document.getElementById('dislikeSingle').disabled = false;
        } catch (error) {
          console.error('Error fetching new suggestion:', error);
          alert('Ocorreu um erro ao buscar novas sugestões. Por favor, tente novamente.');
          isLoading = false;
          document.getElementById('dislikeSingle').textContent = 'Não gostei! Me dê outra';
          document.getElementById('dislikeSingle').disabled = false;
        }
      };
    } else {
      // Show multiple suggestions
      singleSuggestion.classList.add('hidden');
      multipleSuggestions.classList.remove('hidden');
      
      // Clear previous suggestions
      multipleSuggestions.querySelector('div').innerHTML = '';
      
      // Get up to 3 random suggestions
      const maxSuggestions = Math.min(3, suggestions.length);
      const selectedIndexes = [];
      
      // Select random indexes without repetition
      while (selectedIndexes.length < maxSuggestions) {
        const randomIndex = Math.floor(Math.random() * suggestions.length);
        if (!selectedIndexes.includes(randomIndex)) {
          selectedIndexes.push(randomIndex);
        }
      }
      
      // Add suggestion cards
      selectedIndexes.forEach(index => {
        const suggestion = suggestions[index];
        addSuggestionCard(suggestion);
      });
    }
    
    // Scroll to suggestion area
    suggestionArea.scrollIntoView({ behavior: 'smooth' });
  } catch (error) {
    console.error('Error fetching suggestions:', error);
    alert('Ocorreu um erro ao buscar sugestões. Por favor, tente novamente.');
  } finally {
    isLoading = false;
    surpriseButton.textContent = 'Me Surpreenda!';
    surpriseButton.disabled = false;
  }
});

// Helper Functions
function updateTimeValue() {
  timeValue.textContent = `${timeSlider.value}min`;
}

async function fetchSuggestions(time, mood, streaming) {
  if (!time) time = 120; // Default to 120 minutes if not specified
  
  // Ensure mood parameter is valid
  const validMoods = ['alegre', 'nervoso', 'bizarro', 'romântico', 'inteligente'];
  if (mood && !validMoods.includes(mood)) {
    console.warn(`Mood "${mood}" is not in the list of valid moods: ${validMoods.join(', ')}`);
  }
  
  let url = `/api/suggestions?time=${time}`;
  if (mood) {
    url += `&mood=${encodeURIComponent(mood)}`;
  }
  if (streaming && streaming !== "") {
    url += `&streaming=${encodeURIComponent(streaming)}`;
  }
  
  try {
    console.log('Fetching suggestions with URL:', url);
    const response = await fetch(url, {
      credentials: 'include' // Include cookies for authentication
    });
    
    if (!response.ok) {
      // Try to get more information about the error
      let errorDetails = '';
      try {
        const errorData = await response.json();
        errorDetails = JSON.stringify(errorData);
        console.error('API error details:', errorData);
      } catch (parseError) {
        errorDetails = await response.text();
        console.error('API error text:', errorDetails);
      }
      
      throw new Error(`API request failed with status ${response.status}${errorDetails ? ': ' + errorDetails : ''}`);
    }
    
    return await response.json();
  } catch (error) {
    console.error('Error fetching suggestions:', error);
    throw error;
  }
}

function updateSingleSuggestion(suggestion) {
  document.getElementById('singleTitle').textContent = suggestion.title;
  
  // Format duration based on type (movie or TV show)
  const durationText = suggestion.type === 'movie' 
    ? `${suggestion.runtime || 'N/A'} min` 
    : 'Série';
  document.getElementById('singleDuration').textContent = durationText;
  
  // Extract year from release_date or first_air_date
  const year = suggestion.release_date 
    ? suggestion.release_date.substring(0, 4)
    : suggestion.first_air_date 
      ? suggestion.first_air_date.substring(0, 4)
      : 'N/A';
  document.getElementById('singleYear').textContent = year;
  
  // Set description from overview
  document.getElementById('singleDescription').textContent = suggestion.overview || 'Sem descrição disponível';
  
  // Set streaming provider
  document.getElementById('singleStreaming').textContent = suggestion.streaming || 'Não disponível em streaming';
  
  // Set poster image
  const posterUrl = suggestion.poster_path 
    ? `https://image.tmdb.org/t/p/w500${suggestion.poster_path}`
    : 'https://via.placeholder.com/500x750?text=Sem+Poster';
  document.getElementById('singlePoster').src = posterUrl;
  document.getElementById('singlePoster').alt = `Poster de ${suggestion.title}`;
}

// Função para adicionar cards de sugestão - ATUALIZADA com melhor espaçamento
function addSuggestionCard(suggestion) {
  const card = document.createElement('div');
  card.className = 'suggestion-card bg-[#2d2d2d] rounded-xl overflow-hidden flex flex-col h-full transition-all hover:transform hover:-translate-y-1 hover:shadow-lg';
  
  // Mostrar duração formatada corretamente
  const durationText = formatRuntime(suggestion.runtime);
  
  const rating = suggestion.vote_average 
    ? `⭐ ${suggestion.vote_average.toFixed(1)}/10`
    : 'Sem avaliação';
  
  card.innerHTML = `
    <div class="aspect-[2/3] bg-gray-800 overflow-hidden">
      <img src="https://image.tmdb.org/t/p/w500${suggestion.poster_path}" 
           alt="Poster de ${suggestion.title}" 
           class="w-full h-full object-cover hover:opacity-90 transition-opacity">
    </div>
    <div class="p-4 flex-1 flex flex-col gap-3">
      <h3 class="text-lg font-bold line-clamp-2" style="min-height: 3rem;">${suggestion.title}</h3>
      <div class="flex flex-wrap items-center gap-2">
        <span class="bg-[#3d3d3d] text-xs px-2 py-1 rounded whitespace-nowrap">${durationText}</span>
        <span class="bg-[#3d3d3d] text-xs px-2 py-1 rounded">${suggestion.release_date?.substring(0, 4) || 'N/A'}</span>
        <span class="bg-[#3d3d3d] text-xs px-2 py-1 rounded">${rating}</span>
      </div>
      <div class="flex items-center gap-2 flex-wrap">
        <span class="text-gray-400 text-xs">Disponível em:</span>
        <span class="bg-[#E50914] px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap">${suggestion.streaming}</span>
      </div>
      <button class="dislike-button mt-4 bg-[#3d3d3d] hover:bg-[#4d4d4d] text-white py-2 px-4 rounded-full transition-all text-sm w-full">
        Não gostei! Me dê outra
      </button>
    </div>
  `;
  
  multipleSuggestions.querySelector('div').appendChild(card);
  
  // Configurar o botão de "Não gostei"
  const dislikeButton = card.querySelector('.dislike-button');
  dislikeButton.addEventListener('click', async function() {
    if (isLoading) return;
    
    try {
      isLoading = true;
      this.textContent = 'Carregando...';
      this.disabled = true;
      
      const newSuggestions = await fetchSuggestions(selectedTime, selectedMood, selectedStreaming);
      
      if (!newSuggestions || newSuggestions.length === 0) {
        alert('Não temos mais sugestões com esses critérios. Tente outros filtros!');
        return;
      }
      
      const newSuggestion = newSuggestions[Math.floor(Math.random() * newSuggestions.length)];
      
      // Atualizar o cartão com a nova sugestão
      const newDurationText = formatRuntime(newSuggestion.runtime);
      
      const newRating = newSuggestion.vote_average 
        ? `⭐ ${newSuggestion.vote_average.toFixed(1)}/10`
        : 'Sem avaliação';
      
      card.innerHTML = `
        <div class="aspect-[2/3] bg-gray-800 overflow-hidden">
          <img src="https://image.tmdb.org/t/p/w500${newSuggestion.poster_path}" 
               alt="Poster de ${newSuggestion.title}" 
               class="w-full h-full object-cover hover:opacity-90 transition-opacity">
        </div>
        <div class="p-4 flex-1 flex flex-col gap-3">
          <h3 class="text-lg font-bold line-clamp-2" style="min-height: 3rem;">${newSuggestion.title}</h3>
          <div class="flex flex-wrap items-center gap-2">
            <span class="bg-[#3d3d3d] text-xs px-2 py-1 rounded whitespace-nowrap">${newDurationText}</span>
            <span class="bg-[#3d3d3d] text-xs px-2 py-1 rounded">${newSuggestion.release_date?.substring(0, 4) || 'N/A'}</span>
            <span class="bg-[#3d3d3d] text-xs px-2 py-1 rounded">${newRating}</span>
          </div>
          <div class="flex items-center gap-2 flex-wrap">
            <span class="text-gray-400 text-xs">Disponível em:</span>
            <span class="bg-[#E50914] px-2 py-1 rounded-full text-xs font-medium whitespace-nowrap">${newSuggestion.streaming}</span>
          </div>
          <button class="dislike-button mt-4 bg-[#3d3d3d] hover:bg-[#4d4d4d] text-white py-2 px-4 rounded-full transition-all text-sm w-full">
            Não gostei! Me dê outra
          </button>
        </div>
      `;
      
      // Reconfigurar o evento para o novo botão
      const newDislikeButton = card.querySelector('.dislike-button');
      newDislikeButton.addEventListener('click', dislikeButton.click.bind(dislikeButton));
      
    } catch (error) {
      console.error('Erro ao buscar nova sugestão:', error);
      alert('Ocorreu um erro ao buscar nova sugestão.');
    } finally {
      isLoading = false;
      this.textContent = 'Não gostei! Me dê outra';
      this.disabled = false;
    }
  });
}
</script>
<script src="tmdb-integration.js"></script>
</body>
</html>
